SELECT T0.""Project"", T0.""Ref2"", T0.""Ref3"", T1.""Project"" AS ""ProjectLine"", T1.""Ref1"" AS ""Ref1_L"", T1.""Ref2"" AS ""Ref2_L"", T1.""Ref3Line"", T1.""LineMemo"", T1.""OcrCode2"", T1.""OcrCode3"", ""OcrCode4"", T1.""OcrCode5"", T1.""ProfitCode"", T0.""RefDate"", T0.""DueDate"", T0.""TaxDate"", T0.""Memo"", 'PU' AS ""Indicator"", T0.""Ref1"", T0.""TransId"", T1.""Line_ID"", CASE WHEN T1.""Account"" = T1.""ShortName"" THEN 'N' ELSE 'Y' END AS ""SN"", T1.""ShortName"", CASE WHEN T1.""SYSCred"" <> 0 THEN 'Credit' ELSE 'Debit' END AS ""SIDE"", (CASE WHEN IFNULL(T1.""FCCurrency"", '') <> '' AND T1.""FCCredit"" = 0 THEN T1.""FCDebit"" WHEN IFNULL(T1.""FCCurrency"", '') = '' AND T1.""Credit"" = 0 THEN T1.""Debit"" WHEN IFNULL(T1.""FCCurrency"", '') <> '' AND T1.""FCDebit"" = 0 THEN T1.""FCCredit"" WHEN IFNULL(T1.""FCCurrency"", '') = '' AND T1.""Debit"" = 0 THEN T1.""Credit"" END) * "" & ExRate & "" - (CASE WHEN T1.""SYSCred"" = 0 THEN T1.""SYSDeb"" ELSE T1.""SYSCred"" END) AS ""LOCALAMOUNT"", CASE WHEN T1.""SYSCred"" = 0 THEN T1.""SYSDeb"" ELSE T1.""SYSCred"" END AS ""SYSTEMAMOUNT"", CASE WHEN IFNULL(T1.""FCCurrency"", '') <> '' THEN (((T1.""BaseSum"" * "" & ExRate & "") / "" & DocRate & "") - T1.""SYSBaseSum"") ELSE ((T1.""BaseSum"" * "" & ExRate & "") - T1.""SYSBaseSum"") END AS ""BASEAMOUNT"", IFNULL(T1.""VatGroup"", '') AS ""VatGroup"" FROM OJDT T0 INNER JOIN JDT1 T1 ON T0.""TransId"" = T1.""TransId"" WHERE T1.""TransId"" = '"" & oRecordSet.Fields.Item(0).Value.ToString & ""' ORDER BY T0.""TransId"", T1.""Line_ID"" ASC;